2023-11-28 18:03:11.703684: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-11-28 18:03:11.705536: I external/local_tsl/tsl/cuda/cudart_stub.cc:31] Could not find cuda drivers on your machine, GPU will not be used.
2023-11-28 18:03:11.737575: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2023-11-28 18:03:11.737602: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2023-11-28 18:03:11.738519: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2023-11-28 18:03:11.743499: I external/local_tsl/tsl/cuda/cudart_stub.cc:31] Could not find cuda drivers on your machine, GPU will not be used.
2023-11-28 18:03:11.743664: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-11-28 18:03:12.339852: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2023-11-28 18:03:15.003955: W tensorflow/core/common_runtime/gpu/gpu_device.cc:2256] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
dataset cache file:  /home/yuhaoge2/data/tpugraphs/cache/tile/44c1d1b5b349d53913a79a6a496c4893-cache.npz
node_feat (225459, 140)
node_opcode (225459,)
edge_index (236894, 2)
config_feat (10947590, 24)
config_runtime (10947590,)
config_runtime_normalizers (10947590,)
edge_ranges (5626,)
node_ranges (5626,)
config_ranges (5626,)
tile_id (5625,)
loaded from /home/yuhaoge2/data/tpugraphs/cache/tile/44c1d1b5b349d53913a79a6a496c4893-cache.npz
dataset cache file:  /home/yuhaoge2/data/tpugraphs/cache/tile/a0d31b6910f2f0ab2ad99d48e6cecc27-cache.npz
node_feat (31699, 140)
node_opcode (31699,)
edge_index (33519, 2)
config_feat (1042735, 24)
config_runtime (1042735,)
config_runtime_normalizers (1042735,)
edge_ranges (677,)
node_ranges (677,)
config_ranges (677,)
tile_id (676,)
loaded from /home/yuhaoge2/data/tpugraphs/cache/tile/a0d31b6910f2f0ab2ad99d48e6cecc27-cache.npz
dataset cache file:  /home/yuhaoge2/data/tpugraphs/cache/tile/f49ccbd77dd342efcacfac025d19814e-cache.npz
node_feat (30749, 140)
node_opcode (30749,)
edge_index (31747, 2)
config_feat (1420536, 24)
config_runtime (1420536,)
config_runtime_normalizers (1420536,)
edge_ranges (845,)
node_ranges (845,)
config_ranges (845,)
tile_id (844,)
loaded from /home/yuhaoge2/data/tpugraphs/cache/tile/f49ccbd77dd342efcacfac025d19814e-cache.npz
model_name EarlyJoinSAGEAGGSplit
model_class <class 'tpu_graphs.baselines.tiles.models.EarlyJoinSAGEAGGSplit'>
140/140 [==============================] - 41s 257ms/step - loss: 3.1729 - opa_metric: 0.7022 - val_loss: 2.8716 - val_opa_metric: 0.7618
I1128 18:04:07.662043 140335444203328 train_lib.py:154]  * [@0] Validation (NEW BEST): 0.7618451118469238
I1128 18:04:07.662598 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:04:08.824582 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 6968, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_6968, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:04:09.138633 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:04:09.609555 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:04:09.635089 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:04:09.666902 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 34s 238ms/step - loss: 2.6350 - opa_metric: 0.7649 - val_loss: 2.3896 - val_opa_metric: 0.7896
I1128 18:04:44.157916 140335444203328 train_lib.py:154]  * [@1] Validation (NEW BEST): 0.7896056771278381
I1128 18:04:44.158604 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:04:45.177506 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 10646, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_10646, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:04:45.468789 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:04:46.182964 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:04:46.208765 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:04:46.237343 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 239ms/step - loss: 2.3336 - opa_metric: 0.7915 - val_loss: 2.2040 - val_opa_metric: 0.8098
I1128 18:05:20.975948 140335444203328 train_lib.py:154]  * [@2] Validation (NEW BEST): 0.8098471164703369
I1128 18:05:20.976633 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:05:22.171759 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 14295, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_14295, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:05:22.451097 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:05:23.136363 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:05:23.162111 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:05:23.190409 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 34s 237ms/step - loss: 2.1372 - opa_metric: 0.8095 - val_loss: 2.4170 - val_opa_metric: 0.7950
140/140 [==============================] - 35s 244ms/step - loss: 1.9791 - opa_metric: 0.8223 - val_loss: 1.9649 - val_opa_metric: 0.8256
I1128 18:06:32.933125 140335444203328 train_lib.py:154]  * [@4] Validation (NEW BEST): 0.8255826234817505
I1128 18:06:32.933701 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:06:33.937192 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 18636, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_18636, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:06:34.219020 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:06:34.905876 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:06:34.931571 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:06:34.960313 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 34s 236ms/step - loss: 1.9073 - opa_metric: 0.8297 - val_loss: 1.9005 - val_opa_metric: 0.8345
I1128 18:07:09.237511 140335444203328 train_lib.py:154]  * [@5] Validation (NEW BEST): 0.8344709873199463
I1128 18:07:09.238026 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:07:10.428719 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 22285, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_22285, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:07:10.711459 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:07:11.415838 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:07:11.445062 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:07:11.479759 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 241ms/step - loss: 1.7981 - opa_metric: 0.8359 - val_loss: 1.7739 - val_opa_metric: 0.8404
I1128 18:07:46.432359 140335444203328 train_lib.py:154]  * [@6] Validation (NEW BEST): 0.8403785228729248
I1128 18:07:46.432947 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:07:47.454167 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 25934, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_25934, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:07:47.745496 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:07:48.494247 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:07:48.519814 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:07:48.549260 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 238ms/step - loss: 1.7677 - opa_metric: 0.8408 - val_loss: 1.8330 - val_opa_metric: 0.8382
140/140 [==============================] - 34s 236ms/step - loss: 1.6961 - opa_metric: 0.8454 - val_loss: 1.6847 - val_opa_metric: 0.8505
I1128 18:08:58.116928 140335444203328 train_lib.py:154]  * [@8] Validation (NEW BEST): 0.8505294919013977
I1128 18:08:58.117672 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:08:59.310852 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 30275, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_30275, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:08:59.587210 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:09:00.297460 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:09:00.323308 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:09:00.351746 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 238ms/step - loss: 1.6731 - opa_metric: 0.8467 - val_loss: 1.6929 - val_opa_metric: 0.8495
140/140 [==============================] - 35s 239ms/step - loss: 1.6083 - opa_metric: 0.8514 - val_loss: 1.6398 - val_opa_metric: 0.8515
I1128 18:10:09.712638 140335444203328 train_lib.py:154]  * [@10] Validation (NEW BEST): 0.8514765501022339
I1128 18:10:09.713198 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:10:10.703836 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 34616, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_34616, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:10:10.981562 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:10:11.684566 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:10:11.710519 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:10:11.739250 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 36s 247ms/step - loss: 1.6098 - opa_metric: 0.8515 - val_loss: 1.6243 - val_opa_metric: 0.8527
I1128 18:10:47.595739 140335444203328 train_lib.py:154]  * [@11] Validation (NEW BEST): 0.8526707887649536
I1128 18:10:47.596255 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:10:48.818158 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 38265, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_38265, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:10:49.099527 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:10:49.803193 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:10:49.829186 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:10:49.858018 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 37s 257ms/step - loss: 1.5743 - opa_metric: 0.8550 - val_loss: 1.5589 - val_opa_metric: 0.8592
I1128 18:11:27.224566 140335444203328 train_lib.py:154]  * [@12] Validation (NEW BEST): 0.8592368364334106
I1128 18:11:27.225143 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:11:28.217923 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 41914, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_41914, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:11:28.494569 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:11:29.244824 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:11:29.271330 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:11:29.302258 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 36s 251ms/step - loss: 1.5557 - opa_metric: 0.8559 - val_loss: 1.5889 - val_opa_metric: 0.8516
140/140 [==============================] - 37s 256ms/step - loss: 1.5484 - opa_metric: 0.8577 - val_loss: 1.6137 - val_opa_metric: 0.8511
140/140 [==============================] - 37s 254ms/step - loss: 1.5049 - opa_metric: 0.8596 - val_loss: 1.5438 - val_opa_metric: 0.8589
140/140 [==============================] - 37s 254ms/step - loss: 1.4991 - opa_metric: 0.8597 - val_loss: 1.5301 - val_opa_metric: 0.8593
I1128 18:13:56.216587 140335444203328 train_lib.py:154]  * [@16] Validation (NEW BEST): 0.8592961430549622
I1128 18:13:56.217365 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:13:57.436151 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 47639, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_47639, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:13:57.723564 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:13:58.443883 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:13:58.469790 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:13:58.498378 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 244ms/step - loss: 1.4930 - opa_metric: 0.8618 - val_loss: 1.5415 - val_opa_metric: 0.8619
I1128 18:14:34.083317 140335444203328 train_lib.py:154]  * [@17] Validation (NEW BEST): 0.8619225025177002
I1128 18:14:34.083911 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:14:35.086582 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 51288, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_51288, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:14:35.373851 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:14:36.105107 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:14:36.131389 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:14:36.161164 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 240ms/step - loss: 1.4705 - opa_metric: 0.8623 - val_loss: 1.5127 - val_opa_metric: 0.8616
140/140 [==============================] - 35s 243ms/step - loss: 1.4563 - opa_metric: 0.8627 - val_loss: 1.5163 - val_opa_metric: 0.8612
140/140 [==============================] - 35s 242ms/step - loss: 1.4606 - opa_metric: 0.8630 - val_loss: 1.4784 - val_opa_metric: 0.8650
I1128 18:16:21.937282 140335444203328 train_lib.py:154]  * [@20] Validation (NEW BEST): 0.8650219440460205
I1128 18:16:21.938163 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:16:23.187194 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 56321, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_56321, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:16:23.466515 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:16:24.168363 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:16:24.194348 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:16:24.222885 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 241ms/step - loss: 1.4675 - opa_metric: 0.8638 - val_loss: 1.4727 - val_opa_metric: 0.8679
I1128 18:16:59.706026 140335444203328 train_lib.py:154]  * [@21] Validation (NEW BEST): 0.8678792715072632
I1128 18:16:59.706614 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:17:00.696057 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 59970, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_59970, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:17:00.975660 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:17:01.699438 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:17:01.725176 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:17:01.753770 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 36s 244ms/step - loss: 1.4247 - opa_metric: 0.8676 - val_loss: 1.5284 - val_opa_metric: 0.8629
140/140 [==============================] - 35s 238ms/step - loss: 1.4162 - opa_metric: 0.8675 - val_loss: 1.5237 - val_opa_metric: 0.8628
140/140 [==============================] - 35s 241ms/step - loss: 1.4099 - opa_metric: 0.8673 - val_loss: 1.5663 - val_opa_metric: 0.8587
140/140 [==============================] - 35s 242ms/step - loss: 1.4116 - opa_metric: 0.8668 - val_loss: 1.4408 - val_opa_metric: 0.8658
140/140 [==============================] - 35s 245ms/step - loss: 1.3965 - opa_metric: 0.8689 - val_loss: 1.4737 - val_opa_metric: 0.8637
140/140 [==============================] - 35s 241ms/step - loss: 1.3830 - opa_metric: 0.8703 - val_loss: 1.4478 - val_opa_metric: 0.8676
140/140 [==============================] - 35s 240ms/step - loss: 1.3846 - opa_metric: 0.8707 - val_loss: 1.5239 - val_opa_metric: 0.8647
140/140 [==============================] - 35s 240ms/step - loss: 1.3855 - opa_metric: 0.8709 - val_loss: 1.4377 - val_opa_metric: 0.8676
140/140 [==============================] - 35s 241ms/step - loss: 1.3524 - opa_metric: 0.8721 - val_loss: 1.5039 - val_opa_metric: 0.8626
140/140 [==============================] - 35s 242ms/step - loss: 1.3579 - opa_metric: 0.8723 - val_loss: 1.4297 - val_opa_metric: 0.8661
140/140 [==============================] - 35s 240ms/step - loss: 1.3421 - opa_metric: 0.8728 - val_loss: 1.4527 - val_opa_metric: 0.8691
I1128 18:23:29.529279 140335444203328 train_lib.py:154]  * [@32] Validation (NEW BEST): 0.8690775036811829
I1128 18:23:29.530220 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:23:30.731133 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 70539, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_70539, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:23:31.006747 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:23:31.693657 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:23:31.719547 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:23:31.747815 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 240ms/step - loss: 1.3452 - opa_metric: 0.8738 - val_loss: 1.5320 - val_opa_metric: 0.8680
140/140 [==============================] - 35s 241ms/step - loss: 1.3562 - opa_metric: 0.8728 - val_loss: 1.4829 - val_opa_metric: 0.8601
140/140 [==============================] - 35s 240ms/step - loss: 1.3471 - opa_metric: 0.8734 - val_loss: 1.4525 - val_opa_metric: 0.8681
140/140 [==============================] - 35s 243ms/step - loss: 1.3298 - opa_metric: 0.8749 - val_loss: 1.4451 - val_opa_metric: 0.8695
I1128 18:25:52.468422 140335444203328 train_lib.py:154]  * [@36] Validation (NEW BEST): 0.8695046901702881
I1128 18:25:52.469228 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:25:53.474934 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 76264, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_76264, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:25:53.757122 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:25:54.467478 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:25:54.493560 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:25:54.523749 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 37s 252ms/step - loss: 1.3358 - opa_metric: 0.8740 - val_loss: 1.4272 - val_opa_metric: 0.8707
I1128 18:26:31.236164 140335444203328 train_lib.py:154]  * [@37] Validation (NEW BEST): 0.8706620335578918
I1128 18:26:31.236855 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:26:32.211383 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 79913, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_79913, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:26:32.679299 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:26:33.362388 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:26:33.389029 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:26:33.418887 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 37s 252ms/step - loss: 1.3388 - opa_metric: 0.8755 - val_loss: 1.4165 - val_opa_metric: 0.8704
140/140 [==============================] - 37s 256ms/step - loss: 1.3163 - opa_metric: 0.8768 - val_loss: 1.4312 - val_opa_metric: 0.8698
140/140 [==============================] - 37s 255ms/step - loss: 1.3272 - opa_metric: 0.8765 - val_loss: 1.4427 - val_opa_metric: 0.8690
140/140 [==============================] - 37s 255ms/step - loss: 1.3090 - opa_metric: 0.8780 - val_loss: 1.4187 - val_opa_metric: 0.8763
I1128 18:29:01.245834 140335444203328 train_lib.py:154]  * [@41] Validation (NEW BEST): 0.8762617707252502
I1128 18:29:01.246799 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:29:02.235078 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 85638, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_85638, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:29:02.513817 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:29:03.183825 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:29:03.214417 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:29:03.242213 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 37s 252ms/step - loss: 1.3251 - opa_metric: 0.8762 - val_loss: 1.4095 - val_opa_metric: 0.8802
I1128 18:29:40.075034 140335444203328 train_lib.py:154]  * [@42] Validation (NEW BEST): 0.8802199363708496
I1128 18:29:40.075711 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:29:41.060171 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 89287, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_89287, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:29:41.339327 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:29:42.224676 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:29:42.252984 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:29:42.285113 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
140/140 [==============================] - 35s 241ms/step - loss: 1.3165 - opa_metric: 0.8755 - val_loss: 1.4028 - val_opa_metric: 0.8700
140/140 [==============================] - 35s 241ms/step - loss: 1.3118 - opa_metric: 0.8773 - val_loss: 1.4013 - val_opa_metric: 0.8732
140/140 [==============================] - 35s 240ms/step - loss: 1.2990 - opa_metric: 0.8793 - val_loss: 1.4970 - val_opa_metric: 0.8678
140/140 [==============================] - 35s 241ms/step - loss: 1.3152 - opa_metric: 0.8766 - val_loss: 1.4265 - val_opa_metric: 0.8712
140/140 [==============================] - 35s 241ms/step - loss: 1.3013 - opa_metric: 0.8787 - val_loss: 1.3981 - val_opa_metric: 0.8715
140/140 [==============================] - 35s 240ms/step - loss: 1.3045 - opa_metric: 0.8775 - val_loss: 1.4207 - val_opa_metric: 0.8734
140/140 [==============================] - 35s 241ms/step - loss: 1.2849 - opa_metric: 0.8796 - val_loss: 1.3991 - val_opa_metric: 0.8710
140/140 [==============================] - 35s 240ms/step - loss: 1.2956 - opa_metric: 0.8784 - val_loss: 1.3543 - val_opa_metric: 0.8746
140/140 [==============================] - 35s 241ms/step - loss: 1.2994 - opa_metric: 0.8778 - val_loss: 1.3679 - val_opa_metric: 0.8750
140/140 [==============================] - 35s 239ms/step - loss: 1.2922 - opa_metric: 0.8801 - val_loss: 1.3841 - val_opa_metric: 0.8743
140/140 [==============================] - 35s 242ms/step - loss: 1.2765 - opa_metric: 0.8809 - val_loss: 1.4441 - val_opa_metric: 0.8754
140/140 [==============================] - 35s 242ms/step - loss: 1.2803 - opa_metric: 0.8800 - val_loss: 1.4124 - val_opa_metric: 0.8726
140/140 [==============================] - 35s 241ms/step - loss: 1.2744 - opa_metric: 0.8810 - val_loss: 1.3651 - val_opa_metric: 0.8751
140/140 [==============================] - 35s 240ms/step - loss: 1.2737 - opa_metric: 0.8816 - val_loss: 1.3702 - val_opa_metric: 0.8773
140/140 [==============================] - 35s 240ms/step - loss: 1.2629 - opa_metric: 0.8818 - val_loss: 1.3888 - val_opa_metric: 0.8768
140/140 [==============================] - 35s 241ms/step - loss: 1.2832 - opa_metric: 0.8798 - val_loss: 1.3877 - val_opa_metric: 0.8777
140/140 [==============================] - 35s 240ms/step - loss: 1.2661 - opa_metric: 0.8816 - val_loss: 1.3988 - val_opa_metric: 0.8726
140/140 [==============================] - 35s 240ms/step - loss: 1.2707 - opa_metric: 0.8822 - val_loss: 1.3361 - val_opa_metric: 0.8801
140/140 [==============================] - 35s 239ms/step - loss: 1.2708 - opa_metric: 0.8803 - val_loss: 1.4227 - val_opa_metric: 0.8690
140/140 [==============================] - 35s 240ms/step - loss: 1.2646 - opa_metric: 0.8820 - val_loss: 1.3918 - val_opa_metric: 0.8746
I1128 18:41:23.430298 140335444203328 train_lib.py:158] [@62] Best accuracy was attained at epoch 42. Stopping.
I1128 18:53:43.702805 140335444203328 train_lib.py:70] wrote /home/yuhaoge2/out/tpugraphs_tiles/run_88cbaea641610635d9b21656140b7e03.jsonz
I1128 18:53:44.702066 140335444203328 signature_serialization.py:156] Function `_wrapped_model` contains input name(s) args_0, 580925, resource with unsupported characters which will be renamed to args_0_18, early_join_sageagg_split_private__op_embedding_embedding_embedding_lookup_580925, early_join_sageagg_split_sequential_3_dense_6_tensordot_readvariableop_resource in the SavedModel.
I1128 18:53:44.987125 140335444203328 save.py:289] Found untraced functions such as _update_step_xla while saving (showing 1 of 1). These functions will not be directly callable after loading.
INFO:tensorflow:Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:53:45.662265 140335444203328 builder_impl.py:801] Assets written to: /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/assets
I1128 18:53:45.688268 140335444203328 fingerprinting_utils.py:49] Writing fingerprint to /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03/fingerprint.pb
I1128 18:53:45.717755 140335444203328 train_lib.py:75] wrote /home/yuhaoge2/out/tpugraphs_tiles/model_88cbaea641610635d9b21656140b7e03
***  Wrote /home/yuhaoge2/out/tpugraphs_tiles/results_1701216195004.csv
